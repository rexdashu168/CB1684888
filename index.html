<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ÂÖÉÂ§ßÂèØËΩâÂÇµË≥áÊñôÊü•Ë©¢Á≥ªÁµ±</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.18.5/xlsx.full.min.js"></script>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Microsoft JhengHei', Arial, sans-serif;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
            padding: 20px;
            font-size: 15px;
        }

        .container {
            max-width: 1400px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            box-shadow: 0 20px 60px rgba(0,0,0,0.3);
            overflow: hidden;
        }

        .header {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 30px;
            text-align: center;
        }

        .header h1 {
            font-size: 2.5em;
            margin-bottom: 10px;
        }

        .header p {
            font-size: 1.1em;
            opacity: 0.9;
        }

        .upload-section {
            padding: 30px;
            background: #f8f9fa;
            border-bottom: 2px solid #e9ecef;
        }

        .upload-box {
            display: flex;
            align-items: center;
            gap: 20px;
            flex-wrap: wrap;
        }

        .file-input-wrapper {
            position: relative;
            overflow: hidden;
            display: inline-block;
        }

        .file-input-wrapper input[type=file] {
            position: absolute;
            left: -9999px;
        }

        .file-input-label {
            background: #667eea;
            color: white;
            padding: 12px 30px;
            border-radius: 8px;
            cursor: pointer;
            transition: all 0.3s;
            display: inline-block;
            font-weight: bold;
        }

        .file-input-label:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        .file-name {
            color: #495057;
            font-size: 14px;
        }

        .update-time {
            margin-left: auto;
            color: #6c757d;
            font-size: 14px;
        }

        .tabs {
            display: flex;
            background: #f8f9fa;
            border-bottom: 2px solid #dee2e6;
            overflow-x: auto;
        }

        .tab {
            padding: 15px 25px;
            cursor: pointer;
            border: none;
            background: none;
            font-size: 16px;
            font-weight: 500;
            color: #6c757d;
            transition: all 0.3s;
            white-space: nowrap;
        }

        .tab:hover {
            background: #e9ecef;
            color: #495057;
        }

        .tab.active {
            background: white;
            color: #667eea;
            border-bottom: 3px solid #667eea;
        }

        .tab-content {
            display: none;
            padding: 30px;
        }

        .tab-content.active {
            display: block;
        }

        .filters {
            background: #f8f9fa;
            padding: 20px;
            border-radius: 10px;
            margin-bottom: 20px;
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 15px;
        }

        .filter-group {
            display: flex;
            flex-direction: column;
        }

        .filter-group label {
            font-weight: 600;
            margin-bottom: 5px;
            color: #495057;
            font-size: 14px;
        }

        .filter-group input,
        .filter-group select {
            padding: 10px;
            border: 1px solid #ced4da;
            border-radius: 6px;
            font-size: 14px;
            transition: border-color 0.3s;
        }

        .filter-group input:focus,
        .filter-group select:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .filter-buttons {
            grid-column: 1 / -1;
            display: flex;
            gap: 10px;
            justify-content: flex-end;
        }

        .btn {
            padding: 10px 25px;
            border: none;
            border-radius: 6px;
            cursor: pointer;
            font-weight: 600;
            transition: all 0.3s;
            font-size: 14px;
        }

        .btn-primary {
            background: #667eea;
            color: white;
        }

        .btn-primary:hover {
            background: #5568d3;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.3);
        }

        .btn-secondary {
            background: #6c757d;
            color: white;
        }

        .btn-secondary:hover {
            background: #5a6268;
        }

        .table-wrapper {
            overflow-x: auto;
            border-radius: 10px;
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        table {
            width: 100%;
            border-collapse: collapse;
            background: white;
        }

        thead {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
        }

        th {
            padding: 15px 10px;
            text-align: left;
            font-weight: 600;
            font-size: 15px;
            white-space: nowrap;
        }

        td {
            padding: 12px 10px;
            border-bottom: 1px solid #e9ecef;
            font-size: 15px;
        }

        tbody tr:hover {
            background: #f8f9fa;
        }

        .positive {
            color: #dc3545;
        }

        .negative {
            color: #28a745;
        }

        .new-listing {
            color: #dc3545;
            font-weight: bold;
        }

        /* ÈÄ£ÁµêhoverÊïàÊûú */
        a:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 8px rgba(0,0,0,0.2);
        }

        .highlight {
            background: #fff3cd !important;
        }

        .stats-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .stat-card {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 5px 15px rgba(0,0,0,0.2);
        }

        .stat-card h3 {
            font-size: 14px;
            opacity: 0.9;
            margin-bottom: 10px;
        }

        .stat-card .value {
            font-size: 32px;
            font-weight: bold;
            margin-bottom: 5px;
        }

        .stat-card .change {
            font-size: 14px;
            opacity: 0.8;
        }

        .alert {
            padding: 15px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .alert-warning {
            background: #fff3cd;
            border-left: 4px solid #ffc107;
            color: #856404;
        }

        .alert-info {
            background: #d1ecf1;
            border-left: 4px solid #17a2b8;
            color: #0c5460;
        }

        .no-data {
            text-align: center;
            padding: 50px;
            color: #6c757d;
        }

        .loading {
            text-align: center;
            padding: 50px;
            color: #667eea;
            font-size: 18px;
        }

        @media (max-width: 768px) {
            .header h1 {
                font-size: 1.8em;
            }

            .tabs {
                flex-wrap: nowrap;
            }

            .filters {
                grid-template-columns: 1fr;
            }

            .stats-grid {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div style="display: flex; align-items: center; justify-content: center; gap: 15px; margin-bottom: 10px;">
                <span style="font-size: 42px;">üéØ</span>
                <h1 style="margin: 0; font-size: 36px; font-weight: 700;">ÂÖÉÂ§ßÂèØËΩâÂÇµÊü•Ë©¢Á≥ªÁµ±</h1>
            </div>
            <p style="color: rgba(255,255,255,0.95); font-size: 16px; margin: 15px 0; font-weight: 500;">
                Á´∂ÊãçÁµ±Ë®àÊï∏Êìö | Êô∫ËÉΩÊ®°Êì¨ÂàÜÊûê | ÊäïÊ®ôÂÉπÊ†ºË©¶ÁÆó
            </p>
            <div style="display: flex; gap: 15px; justify-content: center; align-items: center; flex-wrap: wrap; margin: 20px 0;">
                <div style="background: rgba(255,255,255,0.25); padding: 10px 20px; border-radius: 25px; font-size: 15px; display: flex; align-items: center; gap: 8px;">
                    <span>üìÖ</span>
                    <span id="current-date"></span>
                </div>
                <a href="https://vocus.cc/user/@rexlife" target="_blank" style="background: rgba(255,255,255,0.25); padding: 10px 20px; border-radius: 25px; font-size: 15px; text-decoration: none; color: white; display: flex; align-items: center; gap: 8px; transition: all 0.3s;">
                    <span>üìù</span>
                    <span>ÊñπÊ†ºÂ≠êÈÉ®ËêΩÊ†º</span>
                </a>
                <a href="https://www.youtube.com/@RexCFP" target="_blank" style="background: rgba(255,255,255,0.25); padding: 10px 20px; border-radius: 25px; font-size: 15px; text-decoration: none; color: white; display: flex; align-items: center; gap: 8px; transition: all 0.3s;">
                    <span>‚ñ∂Ô∏è</span>
                    <span>YouTubeÈ†ªÈÅì</span>
                </a>
            </div>
            <p style="color: rgba(255,255,255,0.9); font-size: 14px; margin-top: 15px;">
                by RexÂ§ßÂèîÁöÑ168Âè∞ËÇ°ÊäïË≥áÊïôÂÆ§
            </p>
            
            <!-- ÁÄèË¶ΩÈáèÁµ±Ë®à -->
            <div style="display: flex; gap: 20px; justify-content: center; margin-top: 15px; font-size: 14px;">
                <div style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 15px;">
                    <span>üëÅÔ∏è ‰ªäÊó•ÁÄèË¶Ω: </span>
                    <span id="today-views" style="font-weight: 600;">0</span>
                </div>
                <div style="background: rgba(255,255,255,0.2); padding: 8px 16px; border-radius: 15px;">
                    <span>üìä Á¥ØÁ©çÁÄèË¶Ω: </span>
                    <span id="total-views" style="font-weight: 600;">0</span>
                </div>
            </div>
        </div>

        <!-- Ë≥áÊñôÊúüÈñìË≥áË®äÊ¢ù -->
        <div style="background: linear-gradient(135deg, #ffeaa7 0%, #fdcb6e 100%); padding: 12px 20px; margin: 20px 0; border-radius: 10px; text-align: center; box-shadow: 0 2px 8px rgba(0,0,0,0.1);">
            <span style="color: #2d3436; font-size: 15px; font-weight: 600;">
                üìä Ë≥áÊñôÊõ¥Êñ∞Êó•ÊúüÔºö<span id="data-period">ËºâÂÖ•‰∏≠...</span>
            </span>
        </div>

        <div class="upload-section">
            <div class="upload-box">
                <div style="display: flex; align-items: center; gap: 20px; width: 100%;">
                    <div style="flex: 1;">
                        <strong style="color: #667eea;">üìä Ë≥áÊñô‰æÜÊ∫êÔºö</strong>
                        <span id="data-source">Ëá™ÂãïËºâÂÖ•‰∏≠...</span>
                    </div>
                    <span class="update-time" id="update-time"></span>
                </div>
            </div>
        </div>

        <div class="tabs">
            <button class="tab active" data-tab="quote">Âç≥ÊôÇÂ†±ÂÉπ</button>
            <button class="tab" data-tab="primary">ÂàùÁ¥öÂ∏ÇÂ†¥</button>
            <button class="tab" data-tab="issued">Â∑≤ÁôºË°åÊ°à‰ª∂</button>
            <button class="tab" data-tab="filter">Â†±ÂÉπÁØ©ÈÅ∏Âô®</button>
            <button class="tab" data-tab="redeem">Ë¥ñÂõûË≥áË®ä</button>
            <button class="tab" data-tab="stop">ÂÅúÊ≠¢ËΩâÊèõ</button>
            <button class="tab" data-tab="balance">ÊµÅÈÄöÈ§òÈ°ç</button>
            <button class="tab" data-tab="adjust">ÂÉπÊ†ºË™øÊï¥</button>
            <button class="tab" data-tab="daily">ÊØèÊó•Ë°åÊÉÖ</button>
        </div>

        <!-- Âç≥ÊôÇÂ†±ÂÉπ -->
        <div id="quote" class="tab-content active">
            <div class="stats-grid" id="stats-grid"></div>
            <div class="table-wrapper">
                <table id="quote-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">‰ª£Á¢º</th>
                            <th style="width: 80px;">ÂêçÁ®±</th>
                            <th style="width: 80px;">Áî¢Ê•≠</th>
                            <th style="width: 70px;">Ê¨äÂà©Èáë</th>
                            <th style="width: 70px;">ÁèæËÇ°ÂÉπ</th>
                            <th style="width: 70px;">ËΩâÊèõÂÉπ</th>
                            <th style="width: 70px;">ËΩâÊèõÂÄº</th>
                            <th style="width: 70px;">CBÂèÉËÄÉÂÉπ</th>
                            <th style="width: 80px;">Ê∫¢ÊäòÂÉπ%</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄÈ´ò</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄ‰Ωé</th>
                            <th style="width: 70px;">È´ò‰ΩéÊåØÂπÖ%</th>
                            <th style="width: 80px;">Ê≥¢ÂãïÁéá120Â§©</th>
                            <th style="width: 70px;">Ââ©È§òÂπ¥Êúü</th>
                            <th style="width: 90px;">Ë≥£ÂõûÊó•</th>
                            <th style="width: 80px;">‰ø°Ë©ï</th>
                        </tr>
                    </thead>
                    <tbody id="quote-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ÂàùÁ¥öÂ∏ÇÂ†¥ -->
        <div id="primary" class="tab-content">
            <div class="alert alert-info">
                <span>üí°</span>
                <div>
                    <strong>ÂàùÁ¥öÂ∏ÇÂ†¥Ë≥áË®äÔºö</strong>Âç≥Â∞áÁôºË°åÊàñÊ≠£Âú®Ë©¢Âúà/Á´∂ÊãçÁöÑÂèØËΩâÂÇµÊ°à‰ª∂
                </div>
            </div>
            <div class="table-wrapper">
                <table id="primary-table">
                    <thead>
                        <tr>
                            <th>Ê®ôÁöÑ‰ª£Ëôü</th>
                            <th>ÁôºË°åÊ®ôÁöÑ</th>
                            <th>Ë©¢Âúà/Á´∂Êãç</th>
                            <th>TCRI/Êìî‰øù</th>
                            <th>ÁôºË°åÈáè(ÂÑÑ)</th>
                            <th>‰∏ªËæ¶Âà∏ÂïÜ</th>
                            <th>ÁîüÊïàÊó•</th>
                            <th>Ë©¢Âúà/ÊäïÊ®ôÊúüÈñì</th>
                            <th>Ê∫¢ÂÉπÁéá</th>
                            <th>ËΩâÊèõÂÉπÊ†º</th>
                            <th>ÊéõÁâåÊó•</th>
                            <th>ÊâøÈä∑ÂÉπÊ†º</th>
                            <th>Âπ¥Êúü</th>
                            <th>Ë≥£ÂõûÊ¢ù‰ª∂</th>
                            <th>ÂÇôË®ª</th>
                        </tr>
                    </thead>
                    <tbody id="primary-tbody"></tbody>
                </table>
            </div>
            
            <div class="alert alert-info" style="margin-top: 30px;">
                <span>üì¢</span>
                <div>
                    <strong>Ëë£‰∫ãÊúÉÂÖ¨ÂëäÊ°à‰ª∂Ôºö</strong>Â∑≤ÈÄöÈÅéËë£‰∫ãÊúÉ‰ΩÜÂ∞öÊú™ÈÄÅ‰ª∂ÊàñÁîüÊïàÁöÑÂèØËΩâÂÇµÊ°à‰ª∂
                </div>
            </div>
            <div class="table-wrapper">
                <table id="board-table">
                    <thead>
                        <tr>
                            <th>CB‰ª£Á¢º</th>
                            <th>ÁôºË°åÊ®ôÁöÑ</th>
                            <th>TCRI/Êìî‰øù</th>
                            <th>ÁôºË°åÈáè(ÂÑÑ)</th>
                            <th>‰∏ªËæ¶Âà∏ÂïÜ</th>
                            <th>Âà∞ÊúüÊó•</th>
                            <th>Ëë£‰∫ãÊúÉÈÄöÈÅéÊó•</th>
                            <th>Ê∫¢ÂÉπÁéá</th>
                            <th>ËΩâÊèõÂÉπÊ†º</th>
                            <th>ÂÇôË®ª</th>
                        </tr>
                    </thead>
                    <tbody id="board-tbody">
                        <tr><td colspan="10" class="no-data">ÁõÆÂâçÁÑ°Ëë£‰∫ãÊúÉÂÖ¨ÂëäÊ°à‰ª∂</td></tr>
                    </tbody>
                </table>
            </div>
        </div>

        <!-- Â∑≤ÁôºË°åÊ°à‰ª∂ -->
        <div id="issued" class="tab-content">
            <div class="alert alert-info">
                <span>üìã</span>
                <div>
                    <strong>Ê≠∑Âè≤ÁôºË°åË®òÈåÑÔºö</strong>Â∑≤ÂÆåÊàêÁôºË°åÁöÑÂèØËΩâÂÇµÊ°à‰ª∂Ë≥áÊñô <span id="issued-date-range" style="color: #667eea;"></span>
                </div>
            </div>
            
            <div class="filters">
                <div class="filter-group">
                    <label>ÁôºË°åÊ®ôÁöÑ</label>
                    <input type="text" id="issued-filter-name" placeholder="Ëº∏ÂÖ•ÈóúÈçµÂ≠óÊêúÂ∞ã">
                </div>
                <div class="filter-group">
                    <label>TCRI/Êìî‰øù</label>
                    <select id="issued-filter-tcri">
                        <option value="">ÂÖ®ÈÉ®</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>‰∏ªËæ¶Âà∏ÂïÜ</label>
                    <select id="issued-filter-broker">
                        <option value="">ÂÖ®ÈÉ®Âà∏ÂïÜ</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Âπ¥Êúü</label>
                    <select id="issued-filter-years">
                        <option value="">ÂÖ®ÈÉ®Âπ¥Êúü</option>
                        <option value="3">3Âπ¥Êúü</option>
                        <option value="5">5Âπ¥Êúü</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>È°çÂ∫¶ÁØÑÂúç(ÂÑÑ)</label>
                    <div style="display: flex; gap: 5px;">
                        <input type="number" id="issued-filter-amount-min" placeholder="ÊúÄÂ∞è" style="width: 70px;">
                        <span style="line-height: 40px;">~</span>
                        <input type="number" id="issued-filter-amount-max" placeholder="ÊúÄÂ§ß" style="width: 70px;">
                    </div>
                </div>
                <div class="filter-buttons">
                    <button class="btn btn-primary" onclick="applyIssuedFilters()">Â•óÁî®ÁØ©ÈÅ∏</button>
                    <button class="btn btn-secondary" onclick="resetIssuedFilters()">ÈáçË®≠</button>
                </div>
            </div>
            
            <div class="table-wrapper">
                <table id="issued-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">‰ª£Á¢º</th>
                            <th style="width: 100px;">ÁôºË°åÊ®ôÁöÑ</th>
                            <th style="width: 90px;">TCRI/Êìî‰øù</th>
                            <th style="width: 70px; cursor: pointer;" onclick="sortIssuedTable('È°çÂ∫¶(ÂÑÑÂÖÉ)')" title="ÈªûÊìäÊéíÂ∫è">
                                È°çÂ∫¶(ÂÑÑ) <span id="sort-amount">‚áÖ</span>
                            </th>
                            <th style="width: 90px;">‰∏ªËæ¶Âà∏ÂïÜ</th>
                            <th style="width: 90px; cursor: pointer;" onclick="sortIssuedTable('ÈÄÅ‰ª∂Êó•')" title="ÈªûÊìäÊéíÂ∫è">
                                ÈÄÅ‰ª∂Êó• <span id="sort-senddate">‚áÖ</span>
                            </th>
                            <th style="width: 90px; cursor: pointer;" onclick="sortIssuedTable('ÁîüÊïàÊó•')" title="ÈªûÊìäÊéíÂ∫è">
                                ÁîüÊïàÊó• <span id="sort-effectdate">‚áÖ</span>
                            </th>
                            <th style="width: 90px;">Ë©¢ÂúàÊúüÈñì</th>
                            <th style="width: 70px; cursor: pointer;" onclick="sortIssuedTable('Ê∫¢ÂÉπÁéá')" title="ÈªûÊìäÊéíÂ∫è">
                                Ê∫¢ÂÉπÁéá <span id="sort-premium">‚áÖ</span>
                            </th>
                            <th style="width: 70px;">ËΩâÊèõÂÉπÊ†º</th>
                            <th style="width: 90px; cursor: pointer;" onclick="sortIssuedTable('ÊéõÁâåÊó•Êúü')" title="ÈªûÊìäÊéíÂ∫è">
                                ÊéõÁâåÊó•Êúü <span id="sort-listdate">‚áÖ</span>
                            </th>
                            <th style="width: 70px;">ÊâøÈä∑ÂÉπÊ†º</th>
                            <th style="width: 60px;">Âπ¥Êúü</th>
                            <th style="min-width: 150px;">Ë≥£ÂõûÊ¢ù‰ª∂</th>
                        </tr>
                    </thead>
                    <tbody id="issued-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Â†±ÂÉπÁØ©ÈÅ∏Âô® -->
        <div id="filter" class="tab-content">
            <div class="filters">
                <div class="filter-group">
                    <label>Áî¢Ê•≠</label>
                    <select id="filter-industry">
                        <option value="">ÂÖ®ÈÉ®Áî¢Ê•≠</option>
                    </select>
                </div>
                <div class="filter-group">
                    <label>Ê∫¢ÊäòÂÉπ% (ÊúÄÂ∞è)</label>
                    <input type="number" id="filter-premium-min" placeholder="‰æã: -10">
                </div>
                <div class="filter-group">
                    <label>Ê∫¢ÊäòÂÉπ% (ÊúÄÂ§ß)</label>
                    <input type="number" id="filter-premium-max" placeholder="‰æã: 50">
                </div>
                <div class="filter-group">
                    <label>Ââ©È§òÂπ¥Êúü (ÊúÄÂ∞è)</label>
                    <input type="number" step="0.1" id="filter-years-min" placeholder="‰æã: 0.5">
                </div>
                <div class="filter-group">
                    <label>Ââ©È§òÂπ¥Êúü (ÊúÄÂ§ß)</label>
                    <input type="number" step="0.1" id="filter-years-max" placeholder="‰æã: 3">
                </div>
                <div class="filter-group">
                    <label>‰ø°Áî®Ë©ïÁ≠â</label>
                    <select id="filter-rating">
                        <option value="">ÂÖ®ÈÉ®Ë©ïÁ≠â</option>
                    </select>
                </div>
                <div class="filter-buttons">
                    <button class="btn btn-primary" onclick="applyFilters()">Â•óÁî®ÁØ©ÈÅ∏</button>
                    <button class="btn btn-secondary" onclick="resetFilters()">ÈáçË®≠</button>
                </div>
            </div>
            <div class="table-wrapper">
                <table id="filter-table">
                    <thead>
                        <tr>
                            <th>‰ª£Á¢º</th>
                            <th>ÂêçÁ®±</th>
                            <th>Áî¢Ê•≠</th>
                            <th>CBÂèÉËÄÉÂÉπ</th>
                            <th>ËΩâÊèõÂÉπÊ†º</th>
                            <th>Ê∫¢ÊäòÂÉπ%</th>
                            <th>Ââ©È§òÂπ¥Êúü</th>
                            <th>ÊéõÁâåÊúÄÈ´ò</th>
                            <th>ÊéõÁâåÊúÄ‰Ωé</th>
                            <th>È´ò‰ΩéÊåØÂπÖ%</th>
                            <th>Ê≥¢ÂãïÁéá120Â§©</th>
                            <th>Ê≥¢ÂãïÁéá240Â§©</th>
                            <th>‰ø°Ë©ï</th>
                        </tr>
                    </thead>
                    <tbody id="filter-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- Ë¥ñÂõûË≥áË®ä -->
        <div id="redeem" class="tab-content">
            <div class="alert alert-warning">
                <span>‚ö†Ô∏è</span>
                <div>
                    <strong>ÈáçË¶ÅÊèêÈÜíÔºö</strong>‰ª•‰∏ãÁÇ∫ÂÖ¨Âè∏Â∑≤Âü∑Ë°åÊàñÂç≥Â∞áÂü∑Ë°åË¥ñÂõûÊ¨äÁöÑÂèØËΩâÂÇµ,Ë´ãÊ≥®ÊÑèASOÂà∞ÊúüÊó•
                </div>
            </div>
            <div class="table-wrapper">
                <table id="redeem-table">
                    <thead>
                        <tr>
                            <th>ÂÖ¨Âè∏‰ª£Ëôü</th>
                            <th>ÂÖ¨Âè∏ÂêçÁ®±</th>
                            <th>Áî≥Â†±Êó•Êúü</th>
                            <th>ASOÂà∞ÊúüÊó•</th>
                            <th>‰∏ªÊó®</th>
                        </tr>
                    </thead>
                    <tbody id="redeem-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ÂÅúÊ≠¢ËΩâÊèõ -->
        <div id="stop" class="tab-content">
            <div class="alert alert-info">
                <span>‚ÑπÔ∏è</span>
                <div>
                    <strong>ÂÅúÊ≠¢ËΩâÊèõÊúüÈñìÔºö</strong>‰ª•‰∏ãÂèØËΩâÂÇµÂú®ÊåáÂÆöÊúüÈñìÁÑ°Ê≥ïÈÄ≤Ë°åËΩâÊèõ
                </div>
            </div>
            <div class="table-wrapper">
                <table id="stop-table">
                    <thead>
                        <tr>
                            <th>ÂÇµÂà∏‰ª£Á¢º</th>
                            <th>ÂÇµÂà∏Á∞°Á®±</th>
                            <th>ÂÅúÊ≠¢ËΩâÊèõËµ∑Êó•</th>
                            <th>ÂÅúÊ≠¢ËΩâÊèõËøÑÊó•</th>
                            <th>ÂÅúÊ≠¢ËΩâÊèõ‰∫ãÁî±</th>
                        </tr>
                    </thead>
                    <tbody id="stop-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ÊµÅÈÄöÈ§òÈ°ç -->
        <div id="balance" class="tab-content">
            <div class="stats-grid" id="balance-stats-grid"></div>
            <div class="table-wrapper">
                <table id="balance-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">Ë≠âÂà∏‰ª£Ëôü</th>
                            <th style="width: 100px;">Ë≠âÂà∏ÂêçÁ®±</th>
                            <th style="width: 80px; cursor: pointer;" onclick="sortBalanceTable('Êú¨ÈÄ±ËÇ°È°ç')" title="ÈªûÊìäÊéíÂ∫è">
                                Êú¨ÈÄ±ËÇ°È°ç <span id="sort-balance-current">‚áÖ</span>
                            </th>
                            <th style="width: 80px;">‰∏äÈÄ±ËÇ°È°ç</th>
                            <th style="width: 80px; cursor: pointer;" onclick="sortBalanceTable('Â¢ûÊ∏õÊï∏È°ç')" title="ÈªûÊìäÊéíÂ∫è">
                                Â¢ûÊ∏õÊï∏È°ç <span id="sort-balance-change">‚áÖ</span>
                            </th>
                            <th style="width: 80px; cursor: pointer;" onclick="sortBalanceTable('Â¢ûÊ∏õÊØîÁéá')" title="ÈªûÊìäÊéíÂ∫è">
                                Â¢ûÊ∏õÊØîÁéá% <span id="sort-balance-ratio">‚áÖ</span>
                            </th>
                            <th style="width: 80px;">Ââ©È§òÊØîÁéá%</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄÈ´ò</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄ‰Ωé</th>
                            <th style="width: 70px;">È´ò‰ΩéÊåØÂπÖ%</th>
                        </tr>
                    </thead>
                    <tbody id="balance-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ÂÉπÊ†ºË™øÊï¥ -->
        <div id="adjust" class="tab-content">
            <div class="alert alert-warning">
                <span>‚ö†Ô∏è</span>
                <div>
                    <strong>ËΩâÊèõÂÉπÊ†ºË™øÊï¥Ôºö</strong>‰ª•‰∏ãÂèØËΩâÂÇµÁöÑËΩâÊèõÂÉπÊ†ºÂ∑≤Ë™øÊï¥ÊàñÂç≥Â∞áË™øÊï¥
                </div>
            </div>
            <div class="table-wrapper">
                <table id="adjust-table">
                    <thead>
                        <tr>
                            <th>ÂÖ¨Âè∏‰ª£Ëôü</th>
                            <th>ÂÖ¨Âè∏ÂêçÁ®±</th>
                            <th>Ë™øÊï¥Ë≥áË®ä</th>
                        </tr>
                    </thead>
                    <tbody id="adjust-tbody"></tbody>
                </table>
            </div>
        </div>

        <!-- ÊØèÊó•Ë°åÊÉÖ -->
        <div id="daily" class="tab-content">
            <div class="table-wrapper">
                <table id="daily-table">
                    <thead>
                        <tr>
                            <th style="width: 60px;">‰ª£Á¢º</th>
                            <th style="width: 80px;">ÂêçÁ®±</th>
                            <th style="width: 80px;">Áî¢Ê•≠</th>
                            <th style="width: 70px;">CBÊî∂Áõ§ÂÉπ</th>
                            <th style="width: 70px;">Êàê‰∫§Èáè</th>
                            <th style="width: 70px;">ËÇ°ÂÉπ</th>
                            <th style="width: 70px;">ËΩâÊèõÂÉπÊ†º</th>
                            <th style="width: 70px;">ËΩâÊèõÂÉπÂÄº</th>
                            <th style="width: 80px;">Ê∫¢ÊäòÂÉπ%</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄÈ´ò</th>
                            <th style="width: 70px;">ÊéõÁâåÊúÄ‰Ωé</th>
                            <th style="width: 70px;">È´ò‰ΩéÊåØÂπÖ%</th>
                            <th style="width: 70px;">YTM</th>
                            <th style="width: 70px;">TCRI</th>
                        </tr>
                    </thead>
                    <tbody id="daily-tbody"></tbody>
                </table>
            </div>
        </div>
    </div>

    <script>
        let workbookData = {};
        let primaryData = {};
        let priceHistoryData = {};
        let currentData = {};
        let issuedDataFull = [];
        let issuedSortOrder = {};
        let balanceSortOrder = {};

        // È†ÅÈù¢ËºâÂÖ•ÊôÇËá™ÂãïËÆÄÂèñÊ™îÊ°à
        window.addEventListener('load', function() {
            loadDataFiles();
        });

        async function loadDataFiles() {
            try {
                document.getElementById('data-source').textContent = 'ËºâÂÖ•‰∏≠...';
                
                // ËºâÂÖ•ÂÖÉÂ§ßÊØèÈÄ±CBË≥áÊñôÂ∫´
                const response1 = await fetch('ÂÖÉÂ§ßÊØèÈÄ±CBË≥áÊñôÂ∫´.xlsx');
                if (response1.ok) {
                    const arrayBuffer1 = await response1.arrayBuffer();
                    const data1 = new Uint8Array(arrayBuffer1);
                    const workbook1 = XLSX.read(data1, {type: 'array'});
                    
                    workbookData = {};
                    workbook1.SheetNames.forEach(sheetName => {
                        workbookData[sheetName] = XLSX.utils.sheet_to_json(workbook1.Sheets[sheetName], {
                            raw: false,
                            defval: ''
                        });
                    });
                }

                // ËºâÂÖ•CBÁôºË°åÊ°à‰ª∂ÂΩôÊï¥
                const response2 = await fetch('CBÁôºË°åÊ°à‰ª∂ÂΩôÊï¥.xlsx');
                if (response2.ok) {
                    const arrayBuffer2 = await response2.arrayBuffer();
                    const data2 = new Uint8Array(arrayBuffer2);
                    const workbook2 = XLSX.read(data2, {type: 'array'});
                    
                    primaryData = {};
                    workbook2.SheetNames.forEach(sheetName => {
                        primaryData[sheetName] = XLSX.utils.sheet_to_json(workbook2.Sheets[sheetName], {
                            raw: false,
                            defval: ''
                        });
                    });
                }

                // ËºâÂÖ•CBÊ≠∑Âè≤ÊéõÁâåÊúÄÈ´ò‰ΩéÂÉπÊü•Ë©¢
                const response3 = await fetch('CBÊ≠∑Âè≤ÊéõÁâåÊúÄÈ´ò‰ΩéÂÉπÊü•Ë©¢.xlsx');
                if (response3.ok) {
                    const arrayBuffer3 = await response3.arrayBuffer();
                    const data3 = new Uint8Array(arrayBuffer3);
                    const workbook3 = XLSX.read(data3, {type: 'array'});
                    
                    priceHistoryData = {};
                    workbook3.SheetNames.forEach(sheetName => {
                        priceHistoryData[sheetName] = XLSX.utils.sheet_to_json(workbook3.Sheets[sheetName], {
                            raw: false,
                            defval: ''
                        });
                    });
                }

                updateTime();
                document.getElementById('data-source').textContent = 'ÂÖÉÂ§ßÊØèÈÄ±CBË≥áÊñôÂ∫´ + CBÁôºË°åÊ°à‰ª∂ÂΩôÊï¥ + CBÊ≠∑Âè≤ÊéõÁâåÊúÄÈ´ò‰ΩéÂÉπÊü•Ë©¢';
                
                loadAllData();
                loadPrimaryData();
            } catch (error) {
                console.error('ËºâÂÖ•Â§±Êïó:', error);
                document.getElementById('data-source').textContent = 'Ê™îÊ°àËºâÂÖ•Â§±Êïó,Ë´ãÁ¢∫Ë™çÊ™îÊ°à‰ΩçÁΩÆ';
            }
        }

        function updateTime() {
            const now = new Date();
            document.getElementById('update-time').textContent = 
                `Êõ¥Êñ∞ÊôÇÈñì: ${now.toLocaleString('zh-TW')}`;
        }

        // Ê†πÊìö‰ª£Á¢ºÁç≤ÂèñÊ≠∑Âè≤ÂÉπÊ†ºË≥áÊñô
        function getPriceHistory(code) {
            if (!priceHistoryData['CBÊ≠∑Âπ¥ÊúÄÈ´òÊúÄ‰ΩéÂÉπ']) {
                return { highest: '-', lowest: '-', range: '-' };
            }
            
            const priceData = priceHistoryData['CBÊ≠∑Âπ¥ÊúÄÈ´òÊúÄ‰ΩéÂÉπ'].find(row => 
                row['‰ª£Ëôü'] == code
            );
            
            if (!priceData) {
                return { highest: '-', lowest: '-', range: '-' };
            }
            
            const highest = parseFloat(priceData['ÊéõÁâåÊúÄÈ´ò']) || 0;
            const lowest = parseFloat(priceData['ÊéõÁâåÊúÄ‰Ωé']) || 0;
            const range = highest && lowest ? ((highest - lowest) / lowest * 100).toFixed(2) : '-';
            
            return {
                highest: highest || '-',
                lowest: lowest || '-',
                range: range
            };
        }

        // TabÂàáÊèõ
        document.querySelectorAll('.tab').forEach(tab => {
            tab.addEventListener('click', function() {
                const tabName = this.dataset.tab;
                
                document.querySelectorAll('.tab').forEach(t => t.classList.remove('active'));
                document.querySelectorAll('.tab-content').forEach(c => c.classList.remove('active'));
                
                this.classList.add('active');
                document.getElementById(tabName).classList.add('active');
            });
        });

        function loadAllData() {
            if (!workbookData['Â†±ÂÉπÂñÆ']) {
                alert('Êâæ‰∏çÂà∞Â†±ÂÉπÂñÆÂ∑•‰ΩúË°®');
                return;
            }

            currentData.quote = workbookData['Â†±ÂÉπÂñÆ'].filter(row => row['ÂèØËΩâÂÇµÂêçÁ®±']);
            currentData.basic = workbookData['Âü∫Êú¨Ë≥áÊñôÊ™î'] || [];
            currentData.redeem = workbookData['ÂÖ¨Âè∏Âü∑Ë°åË¥ñÂõûÊ¨ä'] || [];
            currentData.stop = workbookData['ÂÅúÊ≠¢ËΩâÊèõË≥áË®ä'] || [];
            currentData.balance = workbookData['CBÊµÅÈÄöÂú®Â§ñÈ§òÈ°ç'] || [];
            currentData.adjust = workbookData['ËΩâÊèõÂÉπÊ†ºË™øÊï¥'] || [];
            currentData.daily = workbookData['CBÊØèÊó•Ë°åÊÉÖË°®'] || [];

            loadQuoteTable();
            loadRedeemTable();
            loadStopTable();
            loadBalanceTable();
            loadAdjustTable();
            loadDailyTable();
            loadFilterOptions();
            loadStats();
        }

        function loadPrimaryData() {
            if (!primaryData['ÁôºË°åÊ°à‰ª∂']) {
                alert('Êâæ‰∏çÂà∞ÁôºË°åÊ°à‰ª∂Â∑•‰ΩúË°®');
                return;
            }

            loadPrimaryTable();
            loadIssuedTable();
        }

        function loadStats() {
            if (!currentData.quote || currentData.quote.length === 0) return;

            const totalCB = currentData.quote.length;
            const avgPremium = currentData.quote.reduce((sum, row) => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                return sum + premium;
            }, 0) / totalCB;

            const positiveCount = currentData.quote.filter(row => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                return premium > 0;
            }).length;

            const negativeCount = totalCB - positiveCount;

            const statsHTML = `
                <div class="stat-card">
                    <h3>ÂèØËΩâÂÇµÁ∏ΩÊï∏</h3>
                    <div class="value">${totalCB}</div>
                    <div class="change">Ê™î</div>
                </div>
                <div class="stat-card">
                    <h3>Âπ≥ÂùáÊ∫¢ÊäòÂÉπ</h3>
                    <div class="value">${avgPremium.toFixed(2)}%</div>
                    <div class="change">ÂÖ®Â∏ÇÂ†¥Âπ≥Âùá</div>
                </div>
                <div class="stat-card">
                    <h3>Ê∫¢ÂÉπ‰∫§Êòì</h3>
                    <div class="value">${positiveCount}</div>
                    <div class="change">Ê™î (${(positiveCount/totalCB*100).toFixed(1)}%)</div>
                </div>
                <div class="stat-card">
                    <h3>ÊäòÂÉπ‰∫§Êòì</h3>
                    <div class="value">${negativeCount}</div>
                    <div class="change">Ê™î (${(negativeCount/totalCB*100).toFixed(1)}%)</div>
                </div>
            `;

            document.getElementById('stats-grid').innerHTML = statsHTML;
        }

        function loadQuoteTable() {
            const tbody = document.getElementById('quote-tbody');
            if (!currentData.quote || currentData.quote.length === 0) {
                tbody.innerHTML = '<tr><td colspan="16" class="no-data">Â∞öÊú™ËºâÂÖ•Ë≥áÊñô</td></tr>';
                return;
            }

            tbody.innerHTML = currentData.quote.map(row => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                const premiumClass = premium >= 0 ? 'positive' : 'negative';
                const priceHistory = getPriceHistory(row['ÂèØËΩâÂÇµ‰ª£Á¢º']);
                
                return `
                    <tr>
                        <td>${row['ÂèØËΩâÂÇµ‰ª£Á¢º'] || '-'}</td>
                        <td>${row['ÂèØËΩâÂÇµÂêçÁ®±'] || '-'}</td>
                        <td>${row['Áî¢Ê•≠'] || '-'}</td>
                        <td>${row['Ê¨äÂà©Èáë(‰Ω∞ÂÖÉÂ†±ÂÉπ)'] || '-'}</td>
                        <td>${row['ÁèæËÇ°ÂèÉËÄÉÂÉπ'] || '-'}</td>
                        <td>${row['ËΩâÊèõÂÉπÊ†º'] || '-'}</td>
                        <td>${parseFloat(row['CBËΩâÊèõÂÉπÂÄº'] || 0).toFixed(2)}</td>
                        <td>${row['CBÂèÉËÄÉÂÉπ'] || '-'}</td>
                        <td class="${premiumClass}">${premium.toFixed(2)}%</td>
                        <td>${priceHistory.highest}</td>
                        <td>${priceHistory.lowest}</td>
                        <td>${priceHistory.range}${priceHistory.range !== '-' ? '%' : ''}</td>
                        <td>${row['ËÇ°ÂÉπÊ≥¢ÂãïÁéá120Â§©%'] || '-'}</td>
                        <td>${parseFloat(row['Ââ©È§òÂπ¥Êúü'] || 0).toFixed(2)}</td>
                        <td>${row['Ë≥£ÂõûÊó•Êúü(B)'] || '-'}</td>
                        <td>${row['Êìî‰øùÈäÄË°å/‰ø°Áî®Ë©ïÁ≠â(TCRI)'] || '-'}</td>
                    </tr>
                `;
            }).join('');
        }

        function loadFilterOptions() {
            if (!currentData.quote) return;

            // Áî¢Ê•≠ÈÅ∏È†Ö
            const industries = [...new Set(currentData.quote.map(row => row['Áî¢Ê•≠']).filter(x => x))];
            const industrySelect = document.getElementById('filter-industry');
            industrySelect.innerHTML = '<option value="">ÂÖ®ÈÉ®Áî¢Ê•≠</option>' + 
                industries.map(ind => `<option value="${ind}">${ind}</option>`).join('');

            // ‰ø°Ë©ïÈÅ∏È†Ö
            const ratings = [...new Set(currentData.quote.map(row => row['Êìî‰øùÈäÄË°å/‰ø°Áî®Ë©ïÁ≠â(TCRI)']).filter(x => x))];
            const ratingSelect = document.getElementById('filter-rating');
            ratingSelect.innerHTML = '<option value="">ÂÖ®ÈÉ®Ë©ïÁ≠â</option>' + 
                ratings.map(rating => `<option value="${rating}">${rating}</option>`).join('');

            loadFilterTable();
        }

        function loadFilterTable() {
            const tbody = document.getElementById('filter-tbody');
            if (!currentData.quote || currentData.quote.length === 0) {
                tbody.innerHTML = '<tr><td colspan="13" class="no-data">Â∞öÊú™ËºâÂÖ•Ë≥áÊñô</td></tr>';
                return;
            }

            tbody.innerHTML = currentData.quote.map(row => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                const premiumClass = premium >= 0 ? 'positive' : 'negative';
                const priceHistory = getPriceHistory(row['ÂèØËΩâÂÇµ‰ª£Á¢º']);
                
                return `
                    <tr>
                        <td>${row['ÂèØËΩâÂÇµ‰ª£Á¢º'] || '-'}</td>
                        <td>${row['ÂèØËΩâÂÇµÂêçÁ®±'] || '-'}</td>
                        <td>${row['Áî¢Ê•≠'] || '-'}</td>
                        <td>${row['CBÂèÉËÄÉÂÉπ'] || '-'}</td>
                        <td>${row['ËΩâÊèõÂÉπÊ†º'] || '-'}</td>
                        <td class="${premiumClass}">${premium.toFixed(2)}%</td>
                        <td>${parseFloat(row['Ââ©È§òÂπ¥Êúü'] || 0).toFixed(2)}</td>
                        <td>${priceHistory.highest}</td>
                        <td>${priceHistory.lowest}</td>
                        <td>${priceHistory.range}${priceHistory.range !== '-' ? '%' : ''}</td>
                        <td>${row['ËÇ°ÂÉπÊ≥¢ÂãïÁéá120Â§©%'] || '-'}</td>
                        <td>${row['ËÇ°ÂÉπÊ≥¢ÂãïÁéá240Â§©%'] || '-'}</td>
                        <td>${row['Êìî‰øùÈäÄË°å/‰ø°Áî®Ë©ïÁ≠â(TCRI)'] || '-'}</td>
                    </tr>
                `;
            }).join('');
        }

        function applyFilters() {
            if (!currentData.quote) return;

            const industry = document.getElementById('filter-industry').value;
            const premiumMin = parseFloat(document.getElementById('filter-premium-min').value);
            const premiumMax = parseFloat(document.getElementById('filter-premium-max').value);
            const yearsMin = parseFloat(document.getElementById('filter-years-min').value);
            const yearsMax = parseFloat(document.getElementById('filter-years-max').value);
            const rating = document.getElementById('filter-rating').value;

            const filtered = currentData.quote.filter(row => {
                if (industry && row['Áî¢Ê•≠'] !== industry) return false;
                
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                if (!isNaN(premiumMin) && premium < premiumMin) return false;
                if (!isNaN(premiumMax) && premium > premiumMax) return false;
                
                const years = parseFloat(row['Ââ©È§òÂπ¥Êúü']) || 0;
                if (!isNaN(yearsMin) && years < yearsMin) return false;
                if (!isNaN(yearsMax) && years > yearsMax) return false;
                
                if (rating && row['Êìî‰øùÈäÄË°å/‰ø°Áî®Ë©ïÁ≠â(TCRI)'] !== rating) return false;
                
                return true;
            });

            const tbody = document.getElementById('filter-tbody');
            if (filtered.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="no-data">ÁÑ°Á¨¶ÂêàÊ¢ù‰ª∂ÁöÑË≥áÊñô</td></tr>';
                return;
            }

            tbody.innerHTML = filtered.map(row => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                const premiumClass = premium >= 0 ? 'positive' : 'negative';
                
                return `
                    <tr>
                        <td>${row['ÂèØËΩâÂÇµ‰ª£Á¢º'] || '-'}</td>
                        <td>${row['ÂèØËΩâÂÇµÂêçÁ®±'] || '-'}</td>
                        <td>${row['Áî¢Ê•≠'] || '-'}</td>
                        <td>${row['CBÂèÉËÄÉÂÉπ'] || '-'}</td>
                        <td>${row['ËΩâÊèõÂÉπÊ†º'] || '-'}</td>
                        <td class="${premiumClass}">${premium.toFixed(2)}%</td>
                        <td>${parseFloat(row['Ââ©È§òÂπ¥Êúü'] || 0).toFixed(2)}</td>
                        <td>${row['ËÇ°ÂÉπÊ≥¢ÂãïÁéá120Â§©%'] || '-'}</td>
                        <td>${row['ËÇ°ÂÉπÊ≥¢ÂãïÁéá240Â§©%'] || '-'}</td>
                        <td>${row['Êìî‰øùÈäÄË°å/‰ø°Áî®Ë©ïÁ≠â(TCRI)'] || '-'}</td>
                    </tr>
                `;
            }).join('');
        }

        function resetFilters() {
            document.getElementById('filter-industry').value = '';
            document.getElementById('filter-premium-min').value = '';
            document.getElementById('filter-premium-max').value = '';
            document.getElementById('filter-years-min').value = '';
            document.getElementById('filter-years-max').value = '';
            document.getElementById('filter-rating').value = '';
            loadFilterTable();
        }

        function loadRedeemTable() {
            const tbody = document.getElementById('redeem-tbody');
            if (!currentData.redeem || currentData.redeem.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="no-data">ÁõÆÂâçÁÑ°Ë¥ñÂõûË≥áË®ä</td></tr>';
                return;
            }

            tbody.innerHTML = currentData.redeem.map(row => `
                <tr>
                    <td>${row['ÂÖ¨Âè∏‰ª£Ëôü'] || '-'}</td>
                    <td>${row['ÂÖ¨Âè∏ÂêçÁ®±'] || '-'}</td>
                    <td>${row['Áî≥Â†±Êó•Êúü'] || '-'}</td>
                    <td>${row['ASOÂà∞ÊúüÊó•'] || '-'}</td>
                    <td style="max-width: 500px;">${row['‰∏ªÊó®'] || '-'}</td>
                </tr>
            `).join('');
        }

        function loadStopTable() {
            const tbody = document.getElementById('stop-tbody');
            if (!currentData.stop || currentData.stop.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="no-data">ÁõÆÂâçÁÑ°ÂÅúÊ≠¢ËΩâÊèõË≥áË®ä</td></tr>';
                return;
            }

            // ÂæûÁ¨¨‰∫åÂàóÈñãÂßãËÆÄÂèñ(Ë∑≥ÈÅéÁ¨¨‰∏ÄÂàóÁöÑÊó•ÊúüÊ®ôÈ°å)
            const dataRows = currentData.stop.slice(1).filter(row => {
                const firstCol = Object.values(row)[0];
                return firstCol && firstCol !== 'ÂÇµÂà∏‰ª£Á¢º';
            });

            if (dataRows.length === 0) {
                tbody.innerHTML = '<tr><td colspan="5" class="no-data">ÁõÆÂâçÁÑ°ÂÅúÊ≠¢ËΩâÊèõË≥áË®ä</td></tr>';
                return;
            }

            tbody.innerHTML = dataRows.map(row => {
                const values = Object.values(row);
                return `
                    <tr>
                        <td>${values[0] || '-'}</td>
                        <td>${values[1] || '-'}</td>
                        <td>${values[2] || '-'}</td>
                        <td>${values[3] || '-'}</td>
                        <td>${values[4] || '-'}</td>
                    </tr>
                `;
            }).join('');
        }

        function loadBalanceTable() {
            const tbody = document.getElementById('balance-tbody');
            if (!currentData.balance || currentData.balance.length === 0) {
                tbody.innerHTML = '<tr><td colspan="10" class="no-data">Â∞öÊú™ËºâÂÖ•Ë≥áÊñô</td></tr>';
                return;
            }

            // Ë®àÁÆóÁµ±Ë®àÊï∏Êìö
            const decreaseData = currentData.balance
                .filter(row => parseFloat(row['Â¢ûÊ∏õÊï∏È°ç']) < 0)
                .sort((a, b) => parseFloat(a['Â¢ûÊ∏õÊï∏È°ç']) - parseFloat(b['Â¢ûÊ∏õÊï∏È°ç']));
            
            const maxDecrease = decreaseData[0];
            const maxDecreaseRatio = currentData.balance
                .filter(row => parseFloat(row['Â¢ûÊ∏õÊØîÁéá']) < 0)
                .sort((a, b) => parseFloat(a['Â¢ûÊ∏õÊØîÁéá']) - parseFloat(b['Â¢ûÊ∏õÊØîÁéá']))[0];

            let statsHTML = '';
            if (maxDecrease) {
                statsHTML = `
                    <div class="stat-card">
                        <h3>Ê∏õÂ∞ëÂºµÊï∏ÊúÄÂ§ö</h3>
                        <div class="value">${maxDecrease['Ë≠âÂà∏ÂêçÁ®±']}</div>
                        <div class="change">${maxDecrease['Â¢ûÊ∏õÊï∏È°ç']}Âºµ</div>
                    </div>
                `;
            }
            if (maxDecreaseRatio) {
                statsHTML += `
                    <div class="stat-card">
                        <h3>Ê∏õÂπÖÊØîÁéáÊúÄÂ§ß</h3>
                        <div class="value">${maxDecreaseRatio['Ë≠âÂà∏ÂêçÁ®±']}</div>
                        <div class="change">${maxDecreaseRatio['Â¢ûÊ∏õÊØîÁéá']}%</div>
                    </div>
                `;
            }
            
            const totalDecrease = decreaseData.reduce((sum, row) => 
                sum + Math.abs(parseFloat(row['Â¢ûÊ∏õÊï∏È°ç']) || 0), 0);
            
            statsHTML += `
                <div class="stat-card">
                    <h3>Êú¨ÈÄ±Á∏ΩËΩâÊèõÂºµÊï∏</h3>
                    <div class="value">${totalDecrease.toFixed(0)}</div>
                    <div class="change">Âºµ</div>
                </div>
                <div class="stat-card">
                    <h3>ÊúâËΩâÊèõÁöÑCBÊï∏</h3>
                    <div class="value">${decreaseData.length}</div>
                    <div class="change">Ê™î</div>
                </div>
            `;

            document.getElementById('balance-stats-grid').innerHTML = statsHTML;

            tbody.innerHTML = currentData.balance.map(row => {
                const change = parseFloat(row['Â¢ûÊ∏õÊï∏È°ç']) || 0;
                let changeClass = change > 0 ? 'new-listing' : change < 0 ? 'negative' : '';
                const priceHistory = getPriceHistory(row['Ë≠âÂà∏‰ª£Ëôü']);
                const changeNote = change > 0 ? ' (ÂâõÊéõÁâå)' : '';
                
                return `
                    <tr>
                        <td>${row['Ë≠âÂà∏‰ª£Ëôü'] || '-'}</td>
                        <td>${row['Ë≠âÂà∏ÂêçÁ®±'] || '-'}</td>
                        <td>${row['Êú¨ÈÄ±ËÇ°È°ç'] || '-'}</td>
                        <td>${row['‰∏äÈÄ±ËÇ°È°ç'] || '-'}</td>
                        <td class="${changeClass}">${row['Â¢ûÊ∏õÊï∏È°ç'] || '0'}${changeNote}</td>
                        <td class="${changeClass}">${row['Â¢ûÊ∏õÊØîÁéá'] || '0'}</td>
                        <td>${row['ÁôºË°åÊØîÁéá(Ââ©È§òÊØîÁéá)'] || '-'}</td>
                        <td>${priceHistory.highest}</td>
                        <td>${priceHistory.lowest}</td>
                        <td>${priceHistory.range}${priceHistory.range !== '-' ? '%' : ''}</td>
                    </tr>
                `;
            }).join('');
        }

        function sortBalanceTable(column) {
            if (!balanceSortOrder[column]) {
                balanceSortOrder[column] = 'desc'; // È†êË®≠ÈôçÂ∫è
            } else {
                balanceSortOrder[column] = balanceSortOrder[column] === 'asc' ? 'desc' : 'asc';
            }
            
            const order = balanceSortOrder[column];
            const tbody = document.getElementById('balance-tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            const columnIndex = {
                'Êú¨ÈÄ±ËÇ°È°ç': 2,
                'Â¢ûÊ∏õÊï∏È°ç': 4,
                'Â¢ûÊ∏õÊØîÁéá': 5
            };
            
            const idx = columnIndex[column];
            
            rows.sort((a, b) => {
                let aVal = a.cells[idx].textContent.replace(' (ÂâõÊéõÁâå)', '');
                let bVal = b.cells[idx].textContent.replace(' (ÂâõÊéõÁâå)', '');
                
                const aNum = parseFloat(aVal) || 0;
                const bNum = parseFloat(bVal) || 0;
                return order === 'asc' ? aNum - bNum : bNum - aNum;
            });
            
            tbody.innerHTML = '';
            rows.forEach(row => tbody.appendChild(row));
            
            // Êõ¥Êñ∞ÊéíÂ∫èÂúñÁ§∫
            document.querySelectorAll('[id^="sort-balance-"]').forEach(el => el.textContent = '‚áÖ');
            const sortIconMap = {
                'Êú¨ÈÄ±ËÇ°È°ç': 'sort-balance-current',
                'Â¢ûÊ∏õÊï∏È°ç': 'sort-balance-change',
                'Â¢ûÊ∏õÊØîÁéá': 'sort-balance-ratio'
            };
            const iconId = sortIconMap[column];
            if (iconId) {
                document.getElementById(iconId).textContent = order === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        function loadAdjustTable() {
            const tbody = document.getElementById('adjust-tbody');
            if (!currentData.adjust || currentData.adjust.length === 0) {
                tbody.innerHTML = '<tr><td colspan="3" class="no-data">ÁõÆÂâçÁÑ°ÂÉπÊ†ºË™øÊï¥Ë≥áË®ä</td></tr>';
                return;
            }

            tbody.innerHTML = currentData.adjust.map(row => `
                <tr>
                    <td>${row['ÂÖ¨Âè∏‰ª£Ëôü'] || '-'}</td>
                    <td>${row['ÂÖ¨Âè∏ÂêçÁ®±'] || '-'}</td>
                    <td style="max-width: 600px;">${row['‰∏ªÊó®'] || '-'}</td>
                </tr>
            `).join('');
        }

        function loadDailyTable() {
            const tbody = document.getElementById('daily-tbody');
            if (!currentData.daily || currentData.daily.length === 0) {
                tbody.innerHTML = '<tr><td colspan="14" class="no-data">Â∞öÊú™ËºâÂÖ•Ë≥áÊñô</td></tr>';
                return;
            }

            tbody.innerHTML = currentData.daily.map(row => {
                const premium = parseFloat(row['Ê∫¢(Êäò)ÂÉπ%']) || 0;
                const premiumClass = premium >= 0 ? 'positive' : 'negative';
                const priceHistory = getPriceHistory(row['‰ª£Á¢º']);
                
                return `
                    <tr>
                        <td>${row['‰ª£Á¢º'] || '-'}</td>
                        <td>${row['ÂêçÁ®±  '] || row['ÂêçÁ®±'] || '-'}</td>
                        <td>${row['Áî¢Ê•≠'] || '-'}</td>
                        <td>${row['CBÊî∂Áõ§ÂÉπ'] || '-'}</td>
                        <td>${row['Êàê‰∫§Èáè'] || '-'}</td>
                        <td>${row['ËÇ°ÂÉπ'] || '-'}</td>
                        <td>${row['ËΩâÊèõÂÉπÊ†º'] || '-'}</td>
                        <td>${parseFloat(row['ËΩâÊèõÂÉπÂÄº'] || 0).toFixed(2)}</td>
                        <td class="${premiumClass}">${premium.toFixed(2)}%</td>
                        <td>${priceHistory.highest}</td>
                        <td>${priceHistory.lowest}</td>
                        <td>${priceHistory.range}${priceHistory.range !== '-' ? '%' : ''}</td>
                        <td>${row['YTM'] || '-'}</td>
                        <td>${row['TCRI'] || '-'}</td>
                    </tr>
                `;
            }).join('');
        }

        function loadPrimaryTable() {
            const tbody = document.getElementById('primary-tbody');
            const boardTbody = document.getElementById('board-tbody');
            
            if (!primaryData['ÁôºË°åÊ°à‰ª∂']) {
                tbody.innerHTML = '<tr><td colspan="15" class="no-data">Â∞öÊú™ËºâÂÖ•ÂàùÁ¥öÂ∏ÇÂ†¥Ë≥áÊñô</td></tr>';
                boardTbody.innerHTML = '<tr><td colspan="10" class="no-data">Â∞öÊú™ËºâÂÖ•Ëë£‰∫ãÊúÉÂÖ¨ÂëäË≥áÊñô</td></tr>';
                return;
            }

            // ÈÅéÊøæÊéâÊ®ôÈ°åÂàó
            const allRows = primaryData['ÁôºË°åÊ°à‰ª∂'].filter((row, index) => {
                return index > 0 && row['ÂÖÉÂ§ßË≠âÂÇµÂà∏ÈÉ®CBÂàùÁ¥öÊ°à‰ª∂ÂΩôÊï¥Ë°®'];
            });

            // ÂàÜÈõ¢Ë©¢Âúà/Á´∂ÊãçÊ°à‰ª∂ÂíåËë£‰∫ãÊúÉÂÖ¨ÂëäÊ°à‰ª∂
            const activeRows = allRows.filter(row => {
                const keys = Object.keys(row);
                const type = row[keys[1]]; // Ë©¢Âúà/Á´∂ÊãçÊ¨Ñ‰Ωç
                return type === 'Ë©¢Âúà' || type === 'Á´∂Êãç';
            });

            const boardRows = allRows.filter(row => {
                const keys = Object.keys(row);
                const type = row[keys[1]]; // Ë©¢Âúà/Á´∂ÊãçÊ¨Ñ‰Ωç
                return !type || (type !== 'Ë©¢Âúà' && type !== 'Á´∂Êãç');
            });

            // ËºâÂÖ•Ë©¢Âúà/Á´∂ÊãçÊ°à‰ª∂
            if (activeRows.length === 0) {
                tbody.innerHTML = '<tr><td colspan="15" class="no-data">ÁõÆÂâçÁÑ°ÈÄ≤Ë°å‰∏≠ÁöÑÊ°à‰ª∂</td></tr>';
            } else {
                tbody.innerHTML = activeRows.map(row => {
                    const keys = Object.keys(row);
                    return `
                        <tr>
                            <td>${row[keys[0]] || '-'}</td>
                            <td>${row[keys[2]] || '-'}</td>
                            <td>${row[keys[1]] || '-'}</td>
                            <td>${row[keys[4]] || '-'}</td>
                            <td>${row[keys[5]] || '-'}</td>
                            <td>${row[keys[6]] || '-'}</td>
                            <td>${row[keys[8]] || '-'}</td>
                            <td>${row[keys[9]] || '-'}</td>
                            <td>${row[keys[10]] || '-'}</td>
                            <td>${row[keys[11]] || '-'}</td>
                            <td>${row[keys[12]] || '-'}</td>
                            <td>${row[keys[14]] || '-'}</td>
                            <td>${row[keys[15]] || '-'}</td>
                            <td>${row[keys[16]] || '-'}</td>
                            <td>${row[keys[20]] || '-'}</td>
                        </tr>
                    `;
                }).join('');
            }

            // ËºâÂÖ•Ëë£‰∫ãÊúÉÂÖ¨ÂëäÊ°à‰ª∂
            if (boardRows.length === 0) {
                boardTbody.innerHTML = '<tr><td colspan="10" class="no-data">ÁõÆÂâçÁÑ°Ëë£‰∫ãÊúÉÂÖ¨ÂëäÊ°à‰ª∂</td></tr>';
            } else {
                boardTbody.innerHTML = boardRows.map(row => {
                    const keys = Object.keys(row);
                    return `
                        <tr>
                            <td>${row[keys[0]] || '-'}</td>
                            <td>${row[keys[2]] || '-'}</td>
                            <td>${row[keys[3]] || '-'}</td>
                            <td>${row[keys[4]] || '-'}</td>
                            <td>${row[keys[5]] || '-'}</td>
                            <td>${row[keys[6]] || '-'}</td>
                            <td>${row[keys[8]] || '-'}</td>
                            <td>${row[keys[9]] || '-'}</td>
                            <td>${row[keys[10]] || '-'}</td>
                            <td>${row[keys[20]] || '-'}</td>
                        </tr>
                    `;
                }).join('');
            }
        }

        function loadIssuedTable() {
            const tbody = document.getElementById('issued-tbody');
            if (!primaryData['Â∑≤ÁôºË°å']) {
                tbody.innerHTML = '<tr><td colspan="14" class="no-data">Â∞öÊú™ËºâÂÖ•Â∑≤ÁôºË°åË≥áÊñô</td></tr>';
                return;
            }

            issuedDataFull = primaryData['Â∑≤ÁôºË°å'].filter(row => row['‰ª£Á¢º']);

            if (issuedDataFull.length === 0) {
                tbody.innerHTML = '<tr><td colspan="14" class="no-data">ÁÑ°Â∑≤ÁôºË°åË≥áÊñô</td></tr>';
                return;
            }

            // Ë®àÁÆóÊó•ÊúüÁØÑÂúç
            const dates = issuedDataFull.map(row => row['ÊéõÁâåÊó•Êúü']).filter(d => d);
            if (dates.length > 0) {
                const sortedDates = dates.sort();
                document.getElementById('issued-date-range').textContent = 
                    `(${sortedDates[0]} ~ ${sortedDates[sortedDates.length-1]})`;
            }

            // Â°´ÂÖÖÁØ©ÈÅ∏ÈÅ∏È†Ö
            const tcriSet = new Set(issuedDataFull.map(row => row['TCRI/Êìî‰øù']).filter(x => x));
            const brokerSet = new Set(issuedDataFull.map(row => row['‰∏ªËæ¶Âà∏ÂïÜ']).filter(x => x));
            
            document.getElementById('issued-filter-tcri').innerHTML = '<option value="">ÂÖ®ÈÉ®</option>' +
                Array.from(tcriSet).sort().map(t => `<option value="${t}">${t}</option>`).join('');
            
            document.getElementById('issued-filter-broker').innerHTML = '<option value="">ÂÖ®ÈÉ®Âà∏ÂïÜ</option>' +
                Array.from(brokerSet).sort().map(b => `<option value="${b}">${b}</option>`).join('');

            renderIssuedTable(issuedDataFull);
        }

        function renderIssuedTable(data) {
            const tbody = document.getElementById('issued-tbody');
            tbody.innerHTML = data.map(row => `
                <tr>
                    <td>${row['‰ª£Á¢º'] || '-'}</td>
                    <td>${row['ÁôºË°åÊ®ôÁöÑ'] || '-'}</td>
                    <td>${row['TCRI/Êìî‰øù'] || '-'}</td>
                    <td>${row['È°çÂ∫¶(ÂÑÑÂÖÉ)'] || '-'}</td>
                    <td>${row['‰∏ªËæ¶Âà∏ÂïÜ'] || '-'}</td>
                    <td>${row['ÈÄÅ‰ª∂Êó•'] || '-'}</td>
                    <td>${row['ÁîüÊïàÊó•'] || '-'}</td>
                    <td>${row['Ë©¢ÂúàÊúüÈñì'] || '-'}</td>
                    <td>${row['Ê∫¢ÂÉπÁéá'] || '-'}</td>
                    <td>${row['ËΩâÊèõÂÉπÊ†º'] || '-'}</td>
                    <td>${row['ÊéõÁâåÊó•Êúü'] || '-'}</td>
                    <td>${row['ÊâøÈä∑ÂÉπÊ†º'] || '-'}</td>
                    <td>${row['Âπ¥Êúü'] || '-'}</td>
                    <td>${row['Ë≥£ÂõûÊ¢ù‰ª∂'] || '-'}</td>
                </tr>
            `).join('');
        }

        function applyIssuedFilters() {
            let filtered = [...issuedDataFull];
            
            const name = document.getElementById('issued-filter-name').value.trim();
            if (name) {
                filtered = filtered.filter(row => 
                    (row['ÁôºË°åÊ®ôÁöÑ'] || '').includes(name) || 
                    (row['‰ª£Á¢º'] || '').includes(name)
                );
            }
            
            const tcri = document.getElementById('issued-filter-tcri').value;
            if (tcri) {
                filtered = filtered.filter(row => row['TCRI/Êìî‰øù'] === tcri);
            }
            
            const broker = document.getElementById('issued-filter-broker').value;
            if (broker) {
                filtered = filtered.filter(row => row['‰∏ªËæ¶Âà∏ÂïÜ'] === broker);
            }
            
            const years = document.getElementById('issued-filter-years').value;
            if (years) {
                filtered = filtered.filter(row => (row['Âπ¥Êúü'] || '').includes(years));
            }
            
            const amountMin = parseFloat(document.getElementById('issued-filter-amount-min').value);
            const amountMax = parseFloat(document.getElementById('issued-filter-amount-max').value);
            if (!isNaN(amountMin)) {
                filtered = filtered.filter(row => parseFloat(row['È°çÂ∫¶(ÂÑÑÂÖÉ)'] || 0) >= amountMin);
            }
            if (!isNaN(amountMax)) {
                filtered = filtered.filter(row => parseFloat(row['È°çÂ∫¶(ÂÑÑÂÖÉ)'] || 0) <= amountMax);
            }
            
            renderIssuedTable(filtered);
        }

        function resetIssuedFilters() {
            document.getElementById('issued-filter-name').value = '';
            document.getElementById('issued-filter-tcri').value = '';
            document.getElementById('issued-filter-broker').value = '';
            document.getElementById('issued-filter-years').value = '';
            document.getElementById('issued-filter-amount-min').value = '';
            document.getElementById('issued-filter-amount-max').value = '';
            renderIssuedTable(issuedDataFull);
        }

        function sortIssuedTable(column) {
            if (!issuedSortOrder[column]) {
                issuedSortOrder[column] = 'asc';
            } else {
                issuedSortOrder[column] = issuedSortOrder[column] === 'asc' ? 'desc' : 'asc';
            }
            
            const order = issuedSortOrder[column];
            const tbody = document.getElementById('issued-tbody');
            const rows = Array.from(tbody.querySelectorAll('tr'));
            
            const columnIndex = {
                'È°çÂ∫¶(ÂÑÑÂÖÉ)': 3,
                'ÈÄÅ‰ª∂Êó•': 5,
                'ÁîüÊïàÊó•': 6,
                'Ê∫¢ÂÉπÁéá': 8,
                'ÊéõÁâåÊó•Êúü': 10
            };
            
            const idx = columnIndex[column];
            
            rows.sort((a, b) => {
                const aVal = a.cells[idx].textContent;
                const bVal = b.cells[idx].textContent;
                
                if (column === 'È°çÂ∫¶(ÂÑÑÂÖÉ)' || column === 'Ê∫¢ÂÉπÁéá') {
                    const aNum = parseFloat(aVal) || 0;
                    const bNum = parseFloat(bVal) || 0;
                    return order === 'asc' ? aNum - bNum : bNum - aNum;
                } else {
                    return order === 'asc' ? 
                        aVal.localeCompare(bVal) : 
                        bVal.localeCompare(aVal);
                }
            });
            
            tbody.innerHTML = '';
            rows.forEach(row => tbody.appendChild(row));
            
            // Êõ¥Êñ∞ÊéíÂ∫èÂúñÁ§∫
            document.querySelectorAll('[id^="sort-"]').forEach(el => el.textContent = '‚áÖ');
            const sortIconMap = {
                'È°çÂ∫¶(ÂÑÑÂÖÉ)': 'sort-amount',
                'ÈÄÅ‰ª∂Êó•': 'sort-senddate',
                'ÁîüÊïàÊó•': 'sort-effectdate',
                'Ê∫¢ÂÉπÁéá': 'sort-premium',
                'ÊéõÁâåÊó•Êúü': 'sort-listdate'
            };
            const iconId = sortIconMap[column];
            if (iconId) {
                document.getElementById(iconId).textContent = order === 'asc' ? '‚Üë' : '‚Üì';
            }
        }

        // Êõ¥Êñ∞Áï∂ÂâçÊó•Êúü
        function updateCurrentDate() {
            const now = new Date();
            const options = { year: 'numeric', month: 'long', day: 'numeric', weekday: 'long' };
            const dateStr = now.toLocaleDateString('zh-TW', options);
            document.getElementById('current-date').textContent = dateStr;
            
            // Êõ¥Êñ∞Ë≥áÊñôÊúüÈñì
            const updateTime = now.toLocaleString('zh-TW');
            document.getElementById('data-period').textContent = updateTime;
        }

        // ÁÄèË¶ΩÈáèÁµ±Ë®à
        function updateViewCount() {
            const today = new Date().toDateString();
            const storedDate = localStorage.getItem('visitDate');
            const todayViews = parseInt(localStorage.getItem('todayViews') || '0');
            const totalViews = parseInt(localStorage.getItem('totalViews') || '0');

            if (storedDate === today) {
                localStorage.setItem('todayViews', (todayViews + 1).toString());
            } else {
                localStorage.setItem('visitDate', today);
                localStorage.setItem('todayViews', '1');
            }
            
            localStorage.setItem('totalViews', (totalViews + 1).toString());
            
            document.getElementById('today-views').textContent = localStorage.getItem('todayViews');
            document.getElementById('total-views').textContent = localStorage.getItem('totalViews');
        }

        // È†ÅÈù¢ËºâÂÖ•ÊôÇÂü∑Ë°å
        window.addEventListener('load', function() {
            updateCurrentDate();
            updateViewCount();
        });
    </script>

    <!-- È¢®Èö™ÊèêÈÜíÂíåÁâàÊ¨äË≥áË®ä -->
    <div style="margin: 40px 0 20px 0;">
        <!-- ÈáçË¶ÅÊèêÁ§∫ -->
        <div style="background: linear-gradient(135deg, #fff9e6 0%, #ffe5b4 100%); border: 2px solid #f39c12; border-radius: 15px; padding: 25px; margin-bottom: 20px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <div style="display: flex; align-items: center; gap: 10px; margin-bottom: 15px;">
                <span style="font-size: 24px;">‚ö†Ô∏è</span>
                <h3 style="margin: 0; color: #e67e22; font-size: 18px; font-weight: 700;">ÈáçË¶ÅÊèêÁ§∫</h3>
            </div>
            <div style="color: #5d4037; line-height: 1.8; font-size: 15px;">
                <p style="margin: 10px 0;">Êú¨Á≥ªÁµ±Êèê‰æõÊ≠∑Âè≤Êï∏ÊìöÁµ±Ë®àËàáË≥áÊñôÊï¥ÁêÜÔºåÊâÄÊúâÊï∏ÊìöÂÉÖ‰æõÂèÉËÄÉÔºå‰∏çÊßãÊàê‰ªª‰ΩïÊäïË≥áÂª∫Ë≠∞</p>
                <p style="margin: 10px 0;">ÈÅéÂéªË°®Áèæ‰∏ç‰ª£Ë°®Êú™‰æÜÁµêÊûúÔºåÊäïË≥áÊ±∫Á≠ñË´ãËá™Ë°åË©ï‰º∞È¢®Èö™</p>
            </div>
        </div>

        <!-- Ë≥áÊñô‰æÜÊ∫êÂíåÁâàÊ¨ä -->
        <div style="background: linear-gradient(135deg, #e8eaf6 0%, #c5cae9 100%); border-radius: 15px; padding: 25px; box-shadow: 0 4px 12px rgba(0,0,0,0.1);">
            <div style="text-align: center; margin-bottom: 15px;">
                <p style="color: #5c6bc0; font-size: 15px; margin: 8px 0;">
                    <strong>Ë≥áÊñô‰æÜÊ∫êÔºö</strong>Ë≠âÂà∏Ê´ÉÊ™ØË≤∑Ë≥£‰∏≠ÂøÉ
                </p>
                <p style="color: #e67e22; font-size: 14px; margin: 8px 0;">
                    ‚ö†Ô∏è Êú¨Ë°®ÂÉÖ‰æõÂèÉËÄÉÔºåÊäïË≥áÊ±∫Á≠ñË´ãËá™Ë°åË©ï‰º∞È¢®Èö™
                </p>
            </div>
            
            <div style="border-top: 2px solid rgba(92, 107, 192, 0.3); padding-top: 15px; margin-top: 15px;">
                <div style="text-align: center;">
                    <p style="color: #5c6bc0; font-size: 15px; font-weight: 600; margin: 10px 0;">
                        üìö RexÂ§ßÂèîÁöÑ168Âè∞ËÇ°ÊäïË≥áÊïôÂÆ§
                    </p>
                    <p style="color: #7986cb; font-size: 14px; margin: 8px 0;">
                        Êõ¥Â§öÊäïË≥áËßÄÂøµËàáCBËΩâÂÇµÂàÜÊûêÔºåÊ≠°ËøéË®ÇÈñ±Â≠∏Áøí
                    </p>
                    <div style="display: flex; gap: 15px; justify-content: center; margin-top: 15px; flex-wrap: wrap;">
                        <a href="https://vocus.cc/user/@rexlife" target="_blank" style="color: #5c6bc0; text-decoration: none; font-size: 14px; padding: 8px 16px; background: white; border-radius: 20px; transition: all 0.3s; display: inline-block;">
                            üìù ÊñπÊ†ºÂ≠êÈÉ®ËêΩÊ†º
                        </a>
                        <a href="https://www.youtube.com/@RexCFP" target="_blank" style="color: #5c6bc0; text-decoration: none; font-size: 14px; padding: 8px 16px; background: white; border-radius: 20px; transition: all 0.3s; display: inline-block;">
                            ‚ñ∂Ô∏è YouTubeÈ†ªÈÅì
                        </a>
                    </div>
                </div>
            </div>
        </div>
    </div>

</body>
</html>
