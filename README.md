# 元大可轉債資料查詢系統

## 功能簡介

這是一個完整的可轉債查詢網站,整合了二級市場和初級市場的所有重要資訊。

### 主要功能

1. **即時報價** - 顯示所有可轉債的最新報價、溢折價、波動率等關鍵數據,附帶市場統計
2. **初級市場** - 即將發行或正在詢圈/競拍的CB案件資訊
3. **已發行案件** - 歷史發行記錄,支援多條件篩選和欄位排序
4. **報價篩選器** - 依產業、溢折價、剩餘年期、信評等條件篩選
5. **贖回資訊** - 公司執行贖回權的CB及ASO到期日
6. **停止轉換** - 停止轉換期間提醒
7. **流通餘額** - CB轉換情況追蹤,顯示減少張數最多、減幅最大等統計
8. **價格調整** - 轉換價格調整通知
9. **每日行情** - 完整的每日行情資料

## 部署方式

### 方法一:GitHub Pages (推薦)

1. 在GitHub建立新的repository
2. 將以下檔案上傳到repository根目錄:
   - `index.html`
   - `元大每週CB資料庫.xlsx`
   - `CB發行案件彙整.xlsx`
   - `CB歷史掛牌最高低價查詢.xlsx`

3. 在repository的 Settings > Pages 中:
   - Source 選擇 `main` 分支
   - 點擊 Save

4. 幾分鐘後就可以透過 `https://你的帳號.github.io/repository名稱/` 訪問

### 方法二:本地測試

1. 將四個檔案放在同一個資料夾
2. 使用本地伺服器運行(因為fetch需要HTTP協議):

```bash
# Python 3
python -m http.server 8000

# 然後在瀏覽器打開 http://localhost:8000
```

## 更新資料

### 每週更新流程

1. 更新 `元大每週CB資料庫.xlsx`
2. 更新 `CB發行案件彙整.xlsx` (如有變動)
3. 更新 `CB歷史掛牌最高低價查詢.xlsx` (如有變動)
4. 上傳到GitHub repository
5. 網站會自動重新載入最新資料

**注意:**
- 檔名必須完全一致
- Excel檔案必須與index.html在同一目錄
- 工作表名稱和結構不可更改

## 特色功能說明

### 歷史價格資料整合

所有主要查詢頁面都整合了掛牌以來的最高價、最低價和高低振幅資料:
- **掛牌最高**: 自掛牌以來的歷史最高價
- **掛牌最低**: 自掛牌以來的歷史最低價  
- **高低振幅**: (最高價-最低價)/最低價 × 100%

這些資料可幫助投資人:
- 了解CB的歷史波動範圍
- 評估當前價位的相對位置
- 判斷風險報酬比

### 流通餘額進階功能

- **排序功能**: 可對本週股額、增減數額、增減比率進行升降序排序
- **剛掛牌提醒**: 增減數額為正數時,以紅色粗體標示並註記"(剛掛牌)"
- **統計卡片**: 顯示減少張數最多、減幅最大、總轉換張數、有轉換的CB數

### 董事會公告案件

獨立區塊顯示已通過董事會但尚未送件或生效的CB案件,包含:
- CB代碼、發行標的、TCRI/擔保
- 發行量、主辦券商、到期日
- 董事會通過日、溢價率、轉換價格
- 備註說明

### 已發行案件的進階功能

- **多條件篩選**: 可同時依發行標的、TCRI/擔保、主辦券商、年期、額度範圍篩選
- **欄位排序**: 點擊表頭可對額度、送件日、生效日、溢價率、掛牌日期排序
- **日期範圍顯示**: 自動計算並顯示資料的時間範圍

### 流通餘額統計

- 減少張數最多的CB
- 減幅比率最大的CB
- 本週總轉換張數
- 有轉換的CB數量

### 響應式設計

- 支援桌面、平板、手機瀏覽
- 自動調整欄位寬度
- 表格可左右滑動

## 技術特點

- 純前端實現,無需後端伺服器
- 使用SheetJS (xlsx.js)讀取Excel檔案
- 自動載入,無需手動上傳
- 資料即時篩選和排序
- 溢折價自動上色(紅色=溢價,綠色=折價)

## 瀏覽器相容性

- Chrome 90+
- Firefox 88+
- Safari 14+
- Edge 90+

## 常見問題

### Q: 網站顯示"檔案載入失敗"?
A: 請確認:
1. 兩個Excel檔案與index.html在同一目錄
2. 檔名完全一致(包括大小寫)
3. 使用HTTP伺服器運行(不能直接開啟HTML檔案)

### Q: 如何自訂顯示欄位?
A: 修改index.html中對應表格的<th>標籤和資料載入函數

### Q: 停止轉換無資料?
A: 請確認Excel檔案中"停止轉換資訊"工作表的第一列不是標題列,或已刪除日期標題列

## 更新記錄

### v2.1 (2025-10-30)
- 整合CB歷史掛牌最高低價資料
- 所有主要查詢頁面新增掛牌最高、最低、高低振幅欄位
- 流通餘額新增排序功能(本週股額、增減數額、增減比率)
- 流通餘額增減為正數時以紅色粗體標示並註記"剛掛牌"
- 修正董事會公告案件資料來源和顯示
- 增大整體字體(15px)提升可讀性
- 優化表格欄位寬度

### v2.0 (2025-10-30)
- 新增初級市場功能
- 新增已發行案件查詢(含篩選和排序)
- 優化表格欄位寬度
- 新增流通餘額統計卡片
- 改為自動載入檔案,無需手動上傳
- 優化停止轉換資料讀取

### v1.0 (初版)
- 基本查詢功能
- 二級市場資料展示

## 授權

本專案僅供個人使用,資料來源為元大證券。
