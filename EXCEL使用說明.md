# 📝 超簡單！用Excel更新週報

## 🎯 你只需要會這些：

1. ✅ 打開Excel
2. ✅ 複製貼上
3. ✅ 執行一個指令

**完全不需要懂JSON！** 👍

---

## 📋 每週更新流程（3分鐘完成）

### 步驟1️⃣：打開Excel範本

1. 找到檔案：`data/weekly/週報資料輸入範本.xlsx`
2. 用Excel打開它
3. 你會看到7個工作表：
   - 1.基本資訊
   - 2.成交量排行
   - 3.漲幅排行
   - 4.跌幅排行
   - 5.轉換追蹤
   - 6.贖回公告
   - 使用說明

### 步驟2️⃣：填入資料

打開元大證券的PDF週報，照著這樣複製貼上：

#### 📄 1.基本資訊 工作表
```
週報期間: 2025/11/04~2025/11/08
資料日期: 2025-11-08
```

#### 📊 2.成交量排行 工作表
從PDF複製這些資料：
```
排名  代碼    名稱        成交量(張)
1     30454   台灣大四    5000
2     62822   康舒二      3000
...（繼續複製其他的）
```

#### 📈 3.漲幅排行 工作表
```
排名  代碼    名稱        收盤價   漲幅%
1     33571   臺慶科一    149.00   11.19
2     23372   旺宏二      130.50   11.06
...（繼續複製其他的）
```

#### 📉 4.跌幅排行 工作表
```
排名  代碼    名稱        收盤價   跌幅%
1     47223   國精化三    130.00   -8.74
2     84672   波力二KY    110.65   -6.15
...（記得跌幅要加負號！）
```

#### 🔄 5.轉換追蹤 工作表
```
代碼    名稱      本週張數  上週張數  轉換張數  剩餘比率%
64146   樺漢六    10000     13940    -3940     66.66
...（轉換張數通常是負數）
```

#### ⚠️ 6.贖回公告 工作表
```
代碼    名稱      原發行張數  流通在外  剩餘比率%  終止掛牌日
99211   巨大一    40000      759      1.89      2025/10/30
...
```

### 步驟3️⃣：轉換成JSON

存檔後，執行這個指令：

```bash
python3 scripts/excel_to_json.py data/weekly/週報資料輸入範本.xlsx
```

**就這樣！** 它會自動幫你：
- ✅ 轉換成JSON格式
- ✅ 取好檔案名稱
- ✅ 放到正確位置
- ✅ 告訴你下一步要做什麼

### 步驟4️⃣：上傳到GitHub

看到畫面上的指令，照著執行就好：

```bash
git add data/weekly/20251104-1108.json
git commit -m "新增週報 2025/11/04~2025/11/08"
git push
```

---

## 🎯 完整範例

假設今天是2025年11月8日，你要更新本週的週報：

```bash
# 1. 打開Excel範本
# 用滑鼠雙擊：data/weekly/週報資料輸入範本.xlsx

# 2. 從PDF複製資料到Excel（最花時間的步驟，可能需要5-10分鐘）

# 3. 存檔後，執行轉換
python3 scripts/excel_to_json.py data/weekly/週報資料輸入範本.xlsx

# 4. 看到成功訊息後，執行它告訴你的指令
git add data/weekly/20251104-1108.json
git commit -m "新增週報 2025/11/04~2025/11/08"
git push

# 5. 完成！去網站看看吧
# https://你的用戶名.github.io/cb-tools/
```

---

## ⚠️ 常見問題

### Q: 我不會用終端機/命令提示字元怎麼辦？

**Mac:**
1. 打開 Spotlight（按 Command + 空白鍵）
2. 輸入「終端機」或「Terminal」
3. 按 Enter

**Windows:**
1. 按 Windows鍵 + R
2. 輸入「cmd」
3. 按 Enter

然後用 `cd` 指令進入專案資料夾：
```bash
cd Desktop/cb-tools    # 假設你把專案放在桌面
```

### Q: 轉換時出現錯誤怎麼辦？

**檢查這些：**
1. ✅ 週報期間格式正確嗎？ `2025/11/04~2025/11/08`
2. ✅ 日期格式正確嗎？ `2025-11-08`
3. ✅ 代碼是數字嗎？不要有空格
4. ✅ 跌幅有加負號嗎？ `-8.74`
5. ✅ 有保存Excel檔案嗎？

### Q: 我可以只填部分資料嗎？

**可以！** 有幾筆填幾筆就好。

例如：
- 成交量只有8檔？沒關係，只填8列
- 沒有轉換追蹤？那工作表可以空著

### Q: 每次都要重新填Excel嗎？

**不用！** 你可以：
1. 存一份上週的Excel
2. 這週打開它
3. 改日期和數據就好
4. 另存新檔（或直接覆蓋範本）

---

## 💡 小技巧

### 1. 快速複製PDF資料

1. 在PDF裡選取整個表格
2. Ctrl+C（Mac是 Command+C）
3. 到Excel按 Ctrl+V
4. 調整一下欄位對齊

### 2. 檢查資料

填完後看一眼：
- 代碼都是數字嗎？
- 跌幅有負號嗎？
- 日期格式對嗎？

### 3. 建立每週備份

```bash
# 轉換後，複製一份Excel留底
cp data/weekly/週報資料輸入範本.xlsx data/weekly/20251104-1108.xlsx
```

---

## 🎊 就是這麼簡單！

你已經學會了！現在：

1. 試著填一次看看
2. 執行轉換指令
3. 看到成功訊息就對了

每週重複這個流程，你就能建立完整的CB資料庫了！💪

---

**還有問題嗎？** 
- 看看範本Excel裡的「使用說明」工作表
- 或參考 QUICKSTART.md 獲得更多資訊
